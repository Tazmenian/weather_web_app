<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Sign-in / Sign-up Page</title>
    <link rel="stylesheet" href="login_style.css">
</head>
<body>
    <div class="container" id="container">
        <div class="form-container sign-up">
            <form class="form-signup">
                <i class="fa-regular fa-circle-user"></i>
                <input type="text" placeholder="Name" id="name">
                <input type="email" placeholder="Email" id="email">
                <input type="password" placeholder="Password" id="password">
                <span>or use your email for registration</span>
                <div class="social-icons">
                    <a href="#" class="icon"><i class="fa-brands fa-google"></i><i class="fa-brands fa-facebook"></i><i class="fa-brands fa-github"></i><i class="fa-brands fa-linkedin"></i>
                    </a>
                </div>
                <button>Sign Up</button>
            </form>
        </div>
        <div class="form-container sign-in">
            <form class="form-signin">
                <i class="fa-regular fa-circle-user"></i>
                <input id="email2" type="email" placeholder="Email">
                <input id="password2" type="password" placeholder="Password">
                <span>or use your email password</span>
                <div class="social-icons">
                    <a href="#" class="icon"><i class="fa-brands fa-google"></i><i class="fa-brands fa-facebook"></i><i class="fa-brands fa-github"></i><i class="fa-brands fa-linkedin"></i>
                    </a>
                </div>
                <a href="#">Forget your Password?</a>
                <button id="sign_in">Sign In</button>
            </form>
        </div>
        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-left">
                    <h1>Welcome Back!</h1>
                    <p>Enter your credential to navigate the site</p>
                    <button class="hidden" id="login">Sign In</button>
                </div>
                <div class="toggle-panel toggle-right">
                    <h1>Hi, Guest!</h1>
                    <p>Thank you for visiting this site<br>Hope you'll enjoy</p>
                    
                    <button class="hidden" id="register">Sign Up</button>
                </div>
            </div>
        </div>
    </div>
    <script src="login_script.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA0_utxnjH5oIZayIXd6I2otjUvU1N1KCU",
            authDomain: "complete-weather-app-81b70.firebaseapp.com",
            projectId: "complete-weather-app-81b70",
            storageBucket: "complete-weather-app-81b70.appspot.com",
            messagingSenderId: "826618851730",
            appId: "1:826618851730:web:a69358b17ac9655baa514b"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        // Initialize the Realtime Database
        const db = getDatabase();

        document.querySelector('.form-signup').addEventListener('submit', submitForm);

        function submitForm(e) {
            e.preventDefault();

            var name = getElementVal('name');
            var email = getElementVal('email');
            var password = getElementVal('password');

            const formDataRef = ref(db, 'form-signup'); // Reference to 'form-signup' node
            push(formDataRef, { name, email, password }); // Push data to the database

            console.log(name, email, password);
            alert("Succesfully Registered")
        }

        const getElementVal = (name) => {
            return document.getElementById(name).value;
        }


        document.querySelector('.form-signin').addEventListener('submit', signIn);

        function signIn(e) {
        e.preventDefault();

        const email = document.getElementById('email2').value;
        const password = document.getElementById('password2').value;

        const auth = getAuth();
        signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            // Signed in
            const user = userCredential.user;
            console.log(user);  
            alert("Sign in successful!");

            // Redirect to weather_app.html
        window.location.href = "weather_app.html";
        })
        .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            console.error(errorMessage);
            alert(errorMessage);
        });
    }
        
    </script>
</body>
</html>
